<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Alexander Powers">





<title>Deep Learning Final Project | Alexander Powers</title>






    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
            <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


        
    


    
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-138288591-1', 'auto');
            ga('send', 'pageview');
        </script>
        
<meta name="generator" content="Hexo 4.2.1"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Alex Powers</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Alex Powers</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Deep Learning Final Project</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Alexander Powers</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">December 26, 2019&nbsp;&nbsp;17:55:16</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <link rel="stylesheet" type="text&#x2F;css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><p>This semester, I took a contemporary topics course on deep learning. For the final project, I decided to learn more about multi-task learning (MTL). The final report can be found <a href="https://github.com/abpwrs/ece-5995-fa19/blob/master/final-report.pdf" target="_blank" rel="noopener">here</a>, and the code <a href="https://github.com/abpwrs/ece-5995-fa19" target="_blank" rel="noopener">here</a>.</p>
<h1 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h1><p>This project was an exploration of different hard-parameter sharing architectures, and their impact on classification tasks. The end goal of this project was to develop an intuition for the effects hard-parameter sharing, and to learn how to build networks with multiple inputs and outputs.</p>
<h2 id="CIFAR100"><a href="#CIFAR100" class="headerlink" title="CIFAR100"></a>CIFAR100</h2><p>The CIFAR100 dataset consists of 100 classes of images, which are grouped into 20 super classes. These can be thought of as fine and coarse grain labels.  The data consists of 500 training images, and 100 test images for each fine class. Each image has exactly one fine label and one coarse label. The images in the CIFAR100 dataset are 32x32 RGB (three channel) images, making the network input shape: $(32, 32, 3)$.</p>
<h1 id="Network-Architectures"><a href="#Network-Architectures" class="headerlink" title="Network Architectures"></a>Network Architectures</h1><h4 id="1-Independent-networks-the-control-architecture"><a href="#1-Independent-networks-the-control-architecture" class="headerlink" title="1) Independent networks (the control architecture)"></a>1) Independent networks (the control architecture)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input_image --&gt; conv_layers --&gt; fc_layers --&gt; fine_label</span><br><span class="line">input_image --&gt; conv_layers --&gt; fc_layers --&gt; coarse_label</span><br></pre></td></tr></table></figure>

<h4 id="2-Hard-parameter-sharing-in-convolutional-layers"><a href="#2-Hard-parameter-sharing-in-convolutional-layers" class="headerlink" title="2) Hard parameter sharing in convolutional layers"></a>2) Hard parameter sharing in convolutional layers</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">                           &#x2F;--&gt; fc_layers --&gt; fine_label</span><br><span class="line">input_image --&gt; conv_layers</span><br><span class="line">                           \--&gt; fc_layers --&gt; coarse_label</span><br></pre></td></tr></table></figure>

<h4 id="3-Using-coarse-label-output-as-weights"><a href="#3-Using-coarse-label-output-as-weights" class="headerlink" title="3) Using coarse label output as weights"></a>3) Using coarse label output as weights</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">input_image   ----&gt;   conv_layers   ----&gt;   fc_layers_1</span><br><span class="line">                                                      \</span><br><span class="line">                                                    concat -&gt; fc_layers_2  -&gt; fine_label</span><br><span class="line">                                                      &#x2F;</span><br><span class="line">input_image -&gt; conv_layers -&gt; fc_layers -&gt; coarse_label</span><br></pre></td></tr></table></figure>

<h4 id="4-Using-fine-label-output-as-weights"><a href="#4-Using-fine-label-output-as-weights" class="headerlink" title="4) Using fine label output as weights"></a>4) Using fine label output as weights</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">input_image   ----&gt;   conv_layers   ----&gt;   fc_layers_1</span><br><span class="line">                                                      \</span><br><span class="line">                                                    concat -&gt; fc_layers_2  -&gt; coarse_label</span><br><span class="line">                                                      &#x2F;</span><br><span class="line">input_image -&gt; conv_layers -&gt; fc_layers -&gt; fine_label</span><br></pre></td></tr></table></figure>

<h4 id="5-Combination-of-2-amp-3"><a href="#5-Combination-of-2-amp-3" class="headerlink" title="5) Combination of 2 &amp; 3"></a>5) Combination of 2 &amp; 3</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                         &#x2F; -------------&gt; fc_layers_1</span><br><span class="line">                        &#x2F;                           \</span><br><span class="line">input_image -&gt; conv_layers                        concat -&gt; fc_layers_2 -&gt; fine_label</span><br><span class="line">                        \                           &#x2F;</span><br><span class="line">                         \-&gt; fc_layers -&gt; coarse_label</span><br></pre></td></tr></table></figure>

<h4 id="6-Combination-of-2-amp-4"><a href="#6-Combination-of-2-amp-4" class="headerlink" title="6) Combination of 2 &amp; 4"></a>6) Combination of 2 &amp; 4</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                         &#x2F; -------------&gt; fc_layers_1</span><br><span class="line">                        &#x2F;                           \</span><br><span class="line">input_image -&gt; conv_layers                        concat -&gt; fc_layers_2 -&gt; coarse_label</span><br><span class="line">                        \                           &#x2F;</span><br><span class="line">                         \-&gt; fc_layers -&gt; fine_label</span><br></pre></td></tr></table></figure>

<h1 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h1><p>After training each model with the same hyper-parameters for 100 epochs, I obtained the following results:</p>
<h3 id="Table-of-Metrics-at-Last-Interation-Epoch-100"><a href="#Table-of-Metrics-at-Last-Interation-Epoch-100" class="headerlink" title="Table of Metrics at Last Interation (Epoch 100)"></a>Table of Metrics at Last Interation (Epoch 100)</h3><table>
<thead>
<tr>
<th align="center">Model</th>
<th align="center">Fine Loss</th>
<th align="center">Coarse Loss</th>
<th align="center">Fine Accuracy</th>
<th align="center">Coarse Accuracy</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Independent</td>
<td align="center">1.96</td>
<td align="center">1.15</td>
<td align="center">48.86%</td>
<td align="center">64.16%</td>
</tr>
<tr>
<td align="center">Shared Convolutions</td>
<td align="center">1.94</td>
<td align="center">1.16</td>
<td align="center">49.09%</td>
<td align="center">64.20%</td>
</tr>
<tr>
<td align="center">Reuse Coarse Labels</td>
<td align="center">1.83</td>
<td align="center">1.21</td>
<td align="center">51.50%</td>
<td align="center">62.29%</td>
</tr>
<tr>
<td align="center">Reuse Fine Labels</td>
<td align="center">1.95</td>
<td align="center">1.07</td>
<td align="center">49.14%</td>
<td align="center">68.38%</td>
</tr>
<tr>
<td align="center">Shared Reuse Coarse</td>
<td align="center">1.86</td>
<td align="center">1.16</td>
<td align="center">50.34%</td>
<td align="center">63.91%</td>
</tr>
<tr>
<td align="center">Shared Reuse Fine</td>
<td align="center">1.84</td>
<td align="center">1.06</td>
<td align="center">50.91%</td>
<td align="center">67.11%</td>
</tr>
</tbody></table>
<style>
.row {
  display: flex;
}
.column-two {
  flex: 50%;
  padding: 5px;
}
</style>

<h3 id="Coarse-and-Fine-Classification-Accuracy"><a href="#Coarse-and-Fine-Classification-Accuracy" class="headerlink" title="Coarse and Fine Classification Accuracy"></a>Coarse and Fine Classification Accuracy</h3><div class="row">
  <div class="column-two">
    <img src="/2019/12/26/dl-final-project/val_coarse_output_acc.png" alt="CoarseAcc" style="width:100%">
  </div>
  <div class="column-two">
    <img src="/2019/12/26/dl-final-project/val_fine_output_acc.png" alt="FineAcc" style="width:100%">
  </div>
</div>

<h3 id="Coarse-and-Fine-Classification-Loss"><a href="#Coarse-and-Fine-Classification-Loss" class="headerlink" title="Coarse and Fine Classification Loss"></a>Coarse and Fine Classification Loss</h3><div class="row">
  <div class="column-two">
    <img src="/2019/12/26/dl-final-project/val_coarse_output_loss.png" alt="CoarseLoss" style="width:100%">
  </div>
  <div class="column-two">
    <img src="/2019/12/26/dl-final-project/val_fine_output_loss.png" alt="FineLoss" style="width:100%">
  </div>
</div>

<h1 id="Conclusions-amp-Lessons-Learned"><a href="#Conclusions-amp-Lessons-Learned" class="headerlink" title="Conclusions &amp; Lessons Learned"></a>Conclusions &amp; Lessons Learned</h1><p>We can observe that the reuse of coarse/fine labels significantly benefits the performance of the network on the other task that is not being reused. We should additionally note that the architectures that reuse the coarse labels perform worse on coarse label prediction than the control network. I hypothesize that this is because the error $w.r.t.$ the fine labels is propagated through the layers that predict the coarse label, and that these gradients, while improving fine label classification, slow down and even hurt the coarse label classification.</p>
<p>If I were to redo this experiment, I would train each network until the validation loss started to diverge (not a fixed number of epochs). This would allow me to better assess how these hard-parameter sharing techniques impact convergence rate. I would also train all of these networks multiple times to get average performances for each network. Lastly, I think it would be interesting to examine the impact of convolutional layer weight sharing on transfer learning. I would expect that the weights from shared layers would be more robust and effective for transfer learning than either task independently.</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Alexander Powers</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://alexpowers.dev/2019/12/26/dl-final-project/">https://alexpowers.dev/2019/12/26/dl-final-project/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/deep-learning/"># deep-learning</a>
                    
                        <a href="/tags/multi-task-learning/"># multi-task-learning</a>
                    
                        <a href="/tags/image-classification/"># image-classification</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2019/12/28/ml-final-project/">Machine Learning Final Project</a>
            
            
            <a class="next" rel="next" href="/2019/03/30/bash-talk/">BASH Talk</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Alexander Powers | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
